
# coding: utf-8

# # Introduction to Pandas

# * Pandas is a data analysis library that uses the dataframe construct to analyze data.
# * It is build on top of Numpy - an important scientific library that uses arrays to handle large datasets.
# 
# 
# (FYI): An array is a collection of elements (either values or variables) connected to an array index

# ## What is a dataframe?

# - A dataframe is a two dimensional array that resembles an Excel spreadsheet when printed

# In[22]:

get_ipython().magic(u'matplotlib inline')

#import pandas as pd as a shortcut. We'll see why in the next section
import pandas as pd

#used to make plots of our data
import matplotlib


# ### Getting data into a dataframe

# In[23]:

#defining a variable to read a csv file from the web
twitter_data = pd.read_csv("http://real-chart.finance.yahoo.com/table.csv?s=TWTR&d=6&e=3&f=2015&g=d&a=10&b=7&c=2013&ignore=.csv", header=0)


# * twitter_data will be our array index, and the data within the CSV file will become our two dimensional array
# * pandas uses dot notation - in the above function, we are telling pandas(pd) to pull its read_csv command
# * header=0 tells pandas to view the first row in the CSV file as the header row

# ### Printing the Head and Tail of our Data

# In[24]:

#printing the first five rows, including the header columns
print twitter_data.head()


# In[25]:

#we can also view the last five rows
print twitter_data.tail()


# ### View the entire dataset

# In[26]:

print twitter_data


# * Pandas will show the first and last 30 rows to prevent in memory crashes from large datasets

# ## Creating a Dataframe Subset

# We can create a dataframe from our original dataframe! Let's call our new dataframe "snapshot."

# In[ ]:

snapshot = twitter_data.head(20)
print snapshot


# ### Let's Analyze our Data

# In[27]:

snapshot["Volume"]


# - We create what is called a Series to view a single column

# ### Viewing a Series within a dataframe

# In[ ]:

# this will return boolean values, which are not descriptive enough for our analysis
snapshot["High"] > 36 


# ### Viewing the data where a certain condition is true

# In[ ]:

#if we want to find the days where the stock price high is greater than $36 per share, we can display it like so:
snapshot[snapshot.High > 36]


# In[ ]:

#We find the dates where the Low price is greater than $36 AND the Close price is less than $37
snapshot[(snapshot.Low >= 36) & (snapshot.Close < 37)]


# ### Sorting data by column

# In[28]:

#shortening the twitter_data name
t = twitter_data

#find data where the Open price is higher than $65 and sort by Volume
t[t.Open > 65].sort('Volume')


# ### Simple Descriptive Statistics

# In[34]:

#basic statistics of our data
t.describe()


# ### Append to a dataframe

# In[29]:

#Add a column to calculate the percent change from the day's stock low to the day's stock high
t["Change"] = (t.High - t.Low)/t.Low * 100
print t.head()


# In[30]:

#Get mean for all columns in the twitter_data dataframe
t.mean()


# In[31]:

#Get mean for all columns in the snapshot dataframe
snapshot.mean()


# ### Merging files to create a large dataframe

# In[32]:

#create three new dataframes from three separate csv files
lnkd15_df = pd.read_csv("/Users/moor1204/Desktop/pandas_walkthrough/lnkd_hist2015.csv", header=0)
lnkd14_df = pd.read_csv("/Users/moor1204/Desktop/pandas_walkthrough/lnkd_hist2014.csv", header=0)
lnkd13_df = pd.read_csv("/Users/moor1204/Desktop/pandas_walkthrough/lnkd_hist2013.csv", header=0)

#combine dataframes into a single list
frames = [lnkd15_df, lnkd14_df, lnkd13_df]

#concatinate the list into a single dataframe
lnkd_full = pd.concat(frames)

#print the head and tail to make sure we combined the dataframes correctly
print lnkd_full.head()
print lnkd_full.tail()


# In[ ]:

### Use Matplotlib to 


# In[33]:

lnkd_full.plot(x="High", y="Low")


# In[ ]:

lnkd_full.to_csv('/Users/moor1204/Desktop/pandas_walkthrough/lnkd.csv')

